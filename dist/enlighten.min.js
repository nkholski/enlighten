!function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){(function(e){var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();e.Enlighten=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.language=t.hasOwnProperty("language")?t.language:"en",this.useLocalStorage=!t.hasOwnProperty("useLocalStorage")||t.useLocalStorage,this.api=t.hasOwnProperty("api")?t.api:"https://analytics.makeequal.se/api/words/{language}",this.exclude=[],this.words=[],this.quedTasks=[],this.updated=!1,this.matches=[],this.extraWords=[],this._getWords(),window.enlightenPopup=this._popupPassthrough.bind(this),this.modal=this._addModalHTML()}return t(e,[{key:"config",value:function(e){var t=this;Object.keys(e).forEach(function(n){switch(n){case"language":case"exclude":t[n]=e[n]}})}},{key:"addWord",value:function(e){this._isReady("addWord",e)&&(e.id=-this.extraWords.length-1,this.extraWords.push(e),this._updateMatches())}},{key:"getWord",value:function(e){return e<0?this.extraWords.find(function(t){return t.id===e}):this.words.find(function(t){return t.id===e})}},{key:"insertWordlist",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this._isReady("insertWordlist",e,t,n)){t=t||e;var i=e.length>0?this._getElement(e).innerHTML:"",a=this._getElement(t),r=this._makeWordList(i);n?a.innerHTML+=r:a.innerHTML=r}}},{key:"insertIndex",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(this._isReady("insertIndex",e,t,n,i)){t=t||e;var a=e.length>0?this._getElement(e).innerHTML:"",r=this._getElement(t),o=this._makeIndex(a,i);r.innerHTML=n?o+r.innerHTML:o}}},{key:"parseElement",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this._isReady("parseElement",e,t,n)){var i=this._getElement(e);i.innerHTML=this.parseText(i.innerHTML,t,n)}}},{key:"parseText",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_defaultPopup",a=this._getIdsFromText(e),r=[];return n=!1!==n,i=null===i?"_defaultPopup":i,this.matches.forEach(function(t){if(-1!==a.indexOf(t.word.id)){var o="*"!==t.match.substring(0,1),s="*"!==t.match.substring(t.match.length-1),l=t.match.replace(/\*/g,""),u=new RegExp("<a.*?>.*?</a>|<en-ignore\\b[^>]*>.*?</en-ignore>|"+l+"*.?>|([a-zåäö]*"+l+"[a-zA-ZåäöÅÄÖ]*)","ig");u.test(e)&&(e=e.replace(u,function(e,a){return n||-1===r.indexOf(t.word.id)?o&&0!==e.toLowerCase().indexOf(l)?e:s&&e.toLowerCase().indexOf(l)!==e.length-l.length?e:(r.push(t.word.id),"index"===i?a?"<a href='#ENLIGHT_WORD"+t.word.id+"' class='enlighten-clickable'>"+a+"</a>":e:a?"<a onClick='enlightenPopup("+t.word.id+',"'+i+"\")' class='enlighten-clickable'>"+a+"</a>":e):e}))}}),e=e.replace(/<enlighten\ data-word\=[\'\"](.*?)[\'\"]\>(.*?)<\/enlighten>/gi,function(e,n,a){var r=!1,o=void 0;return t.matches.forEach(function(e){if(!r)return e.match===n.toLowerCase()?(o=e,void(r=!0)):void 0}),r?"index"===i?n?"<a href='#ENLIGHT_WORD"+o.word.id+"' class='enlighten-clickable'>"+a+"</a>":e:n?"<a onClick='enlightenPopup("+o.word.id+',"'+i+"\")' class='enlighten-clickable'>"+a+"</a>":e:e})}},{key:"_getIdsFromText",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=[];return t=(t=(t=t.replace(/<en\-ignore\>.*?<\/en-ignore>/gi,"")).replace(/<enlighten (.*?)>.*?<\/enlighten>/gi,"$1")).replace(/<.*?>/gi,""),this.matches.forEach(function(i){if(-1===n.indexOf(i.word.id)&&-1===e.exclude.indexOf(i.word.id))if(0!==t.length){var a="*"!==i.match.substring(0,1),r="*"!==i.match.substring(i.match.length-1),o=i.match.replace(/\*/g,""),s=a?"(^|[^a-zåäöÅÄÖ])":"";s+=o,s+=r?"($|[^a-zåäöÅÄÖ])":"",new RegExp(s,"i").test(t)&&n.push(i.word.id)}else n.push(i.word.id)}),n}},{key:"_makeIndex",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i="";return this._alphabetizeIds(this._getIdsFromText(e)).forEach(function(e){i+=n?'<li><a href="#ENLIGHT_WORD'+e+'">'+t.getWord(e).title+"</a></li>\n":"<li>"+t.getWord(e).title+"</li>\n"}),'\n      <div class="enlighten-index">\n        <ol>\n          '+i+"\n        </ol>\n      </div>\n    "}},{key:"_makeWordList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i="";return this._alphabetizeIds(this._getIdsFromText(t)).forEach(function(t){var a=e.getWord(t);i+='<div class="enlighten-word">',n&&(i+='<a name="ENLIGHT_WORD'+t+'"></a>'),i+="<h3>"+a.title+"</h3>\n             <span>"+a.text+"</span>\n           </div>"}),'<div class="enlighten-word-explainations">\n           '+i+"\n       </div>\n     "}},{key:"_popupPassthrough",value:function(e,t){var n=this.getWord(e);"_defaultPopup"===t?this._defaultPopup(e,n.title,n.text):window[t](e,n.title,n.text)}},{key:"_defaultPopup",value:function(e,t,n){var i=document.getElementById("enlightenModal");i.style.display="block",i.getElementsByTagName("h3")[0].innerHTML=t,i.getElementsByTagName("p")[0].innerHTML=n}},{key:"_getElement",value:function(e){return e.indexOf("#")>-1?document.getElementById(e.substring(1)):document.getElementsByClassName(e.substring(1))[0]}},{key:"_updateMatches",value:function(){var e=[];this.words.concat(this.extraWords).forEach(function(t){t.matches.forEach(function(n){e.push({match:n,word:t})})}),e.sort(function(e,t){return t.match.length-e.match.length}),this.matches=e}},{key:"_alphabetizeIds",value:function(e){var t=this;return e.sort(function(e,n){return t.getWord(e).title.localeCompare(t.getWord(n).title)})}},{key:"_getWords",value:function(){var e=this,t=localStorage.getItem("enlighten_words_"+this.language);t&&t.length>0&&(this.words=JSON.parse(t),this._updateMatches()),this._ajaxGet().then(function(t){e.words=JSON.parse(t).data,localStorage.setItem("enlighten_words_"+e.language,JSON.stringify(e.words)),e._updateMatches(),e.updated=!0,e._executeQue()})}},{key:"_isReady",value:function(){if(this.words.length>0&&(this.useLocalStorage||this.updated))return!0;for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._addToQue(t)}},{key:"_addToQue",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0].shift();this.quedTasks.push({method:i,args:t[0]})}},{key:"_executeQue",value:function(){var e=this;this.quedTasks.forEach(function(t){e[t.method].apply(e,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t.args))}),this.quedTasks=[]}},{key:"_ajaxGet",value:function(){var e=this;return new Promise(function(t,n){var i=e.api.replace("{language}",e.language),a=new XMLHttpRequest;a.open("GET",i),a.onload=function(){200===a.status?t(a.response):n(new Error(a.statusText))},a.onerror=function(){n(new Error("Network error"))},a.send()})}},{key:"_addModalHTML",value:function(){var e=document.createElement("div");return e.setAttribute("id","enlightenModal"),e.setAttribute("class","modal"),e.innerHTML='\n          <div class="modal-content">\n            <span class="close">&times;</span>\n            <h3>Title</h3>\n            <p>Content</p>\n          </div>f',document.getElementsByTagName("body")[0].appendChild(e),document.getElementsByClassName("close")[0].onclick=function(){e.style.display="none"},window.onclick=function(t){"enlightenModal"===t.target.id&&(e.style.display="none")},e}}]),e}()}).call(this,n(0))}]);
//# sourceMappingURL=enlighten.min.js.map